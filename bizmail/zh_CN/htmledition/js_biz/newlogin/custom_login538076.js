$(function(){var e=$.fn.countryCodeDropdown,i=86,t=null,a=$(document),n=($("#loginForm div[data-panel=qrcode]"),$("#loginForm div[data-panel=pwd]"),$(".js_show_pwd_panel"),$(".js_show_qrcode_panel"),$(".login_content_wrap[data-content-type=qrcode]"),$(".login_content_wrap[data-content-type=verifycode]"),$(".js_verify_item"),$("#btn_sms")),o=$("#mobile"),s=$("#area"),r=$("#sms_token"),d=($("#sms_token2"),$("#sms_login_btn")),c=($("#wx_token"),$("#vc"),$("#token"),$("#inputuin"),$("#pp"),$("#VerifyArea"),$("#sms_token2_login"),$("#wx_token_login"),$("#get_verify_code_btn"),0),l=$(".js_login_item_wrapper"),_=$("#js_login_captcha_img"),m=($("#js_login_captcha_img"),$('input[name="captcha_val"]')),p=!1,u=!1,f=$("#phone_bind_account_list"),h=!1,g=getCookie&&"en_US"==getCookie("qycustom.i18n_lan")?"en_US":"zh_CN",v={en_US:{"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801":"mobile format error","\u5c1a\u672a\u7ed1\u5b9a\u624b\u673a\uff0c\u65e0\u6cd5\u53d1\u9001\u9a8c\u8bc1\u7801":"mobile unbind","\u64cd\u4f5c\u901f\u5ea6\u8fc7\u5feb\uff0c\u8bf71\u5206\u949f\u540e\u91cd\u65b0\u5c1d\u8bd5":"operation too fast, please try 1 minute later","\u8bf7\u8f93\u5165\u56fe\u7247\u9a8c\u8bc1\u7801":"verify code needed","\u8be5\u624b\u673a\u53f7\u7684\u9a8c\u8bc1\u7801\u83b7\u53d6\u6b21\u6570\u5df2\u5230\u8fbe\u6bcf\u65e5\u4e0a\u9650":"verify code has reached daily limit","\u9a8c\u8bc1\u7801\u53d1\u9001\u5931\u8d25":"verify code send failed","\u8bf7\u8f93\u5165\u77ed\u4fe1\u9a8c\u8bc1\u7801":"sms code needed","\u8be5\u624b\u673a\u6682\u65e0\u7ed1\u5b9a\u5e10\u53f7":"mobile unbind","\u53c2\u6570\u9519\u8bef":"invalid param","\u9a8c\u8bc1\u7801\u9519\u8bef":"verify code error","\u7cfb\u7edf\u5931\u8d25":"system error","\u4f60\u7684\u4f01\u4e1a\u90ae\u7bb1\u5e10\u53f7\u88ab\u7981\u7528\uff0c\u8bf7\u8054\u7cfb\u4f01\u4e1a\u90ae\u7bb1\u7ba1\u7406\u5458\u3002":"account disabled, please contact admin","\u7ba1\u7406\u5458\u9650\u5236\u8be5IP\u767b\u5f55\u4f01\u4e1a\u90ae\u7bb1\u3002":"ip restricted by admin","\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5\u3002\u9519\u8bef\u7801\uff1a":"login failed, try later. error: ","\u7cfb\u7edf\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5":"login failed, try later","\u767b\u5f55\u5931\u8d25\uff0c\u9519\u8bef\u7801\uff1a":"login failed. error: ","\u91cd\u65b0\u53d1\u9001(":"resend(","\u83b7\u53d6\u9a8c\u8bc1\u7801":"Get code"}};function w(e){return(v[g]||{})[e]||e}function y(e){e.on("keypress",function(e){if(console.log("keydown e.keyCode = ",e.keyCode),13==e.keyCode)return e.preventDefault(),!1})}function b(e,i,t){var a,n="";0!=(t=t||0)&&((a=new Date).setTime(a.getTime()+1e3*t),n="; expires="+a.toGMTString()),document.cookie=e+"="+escape(i)+n+"; path=/"}function x(e){e=T(e);f.html(e),$(".js_input_area").hide(),$(".js_list_area").show(),"02"==window.custom_layout&&($(".preview_head").hide(),$(".company_main").css("border-radius","4px"),$(".bg_color").css("border-radius","4px")),"05"==window.custom_layout&&($(".right_panel").hide(),$(".mid_line").hide())}function j(e,i){(new Image).src="https://exmail.qq.com/qy_mng_logic/reportKV?type="+e+"&itemName="+i+"&r="+Math.random()}function I(){if(o&&t){var e=$.trim(o.val());return t.isValidMobile(t.getValue(),e)&&/^[0-9]+$/.test(e)}return 1}function L(e,i){e=e.parents(".company_input_wrap").eq(0);e.addClass("company_input_wrap_error"),i&&e.find(".company_input_wrap_errmsg").text(i)}function C(e){e=e.parents(".company_input_wrap").eq(0);e.removeClass("company_input_wrap_error"),e.find(".company_input_wrap_errmsg").text("")}function k(e){document.form1.f.value="biz",document.form1.fun.value="",document.form1.vt.value="mobilecode",document.form1.uin.value=e,document.form1.inputuin.value="",document.form1.ppp.value="",document.form1.pp.value="",document.form1.submit()}function T(e){for(var i,t=[],a=0;a<e.length;a++){var n=e[a];"0"==n.owner?t.push(['<div class="weixin_choose_list_item weixin_choose_list_item_member" data-uin="',(i=n).alias,'" data-type="member" data-verify="',i.need_verify,'" data-mobile="',i.authmobile,'" data-area="',i.autharea,'">','<div class="weixin_choose_list_item_icon">','<div class="weixin_choose_member_icon"></div>',1==i.need_verify?'<div class="to_be_verify">\u5f85\u9a8c\u8bc1</div>':"","</div>",'<div class="weixin_choose_list_item_content">','<div class="weixin_choose_list_item_title">\u6210\u5458</div>','<div class="weixin_choose_list_item_alias">',i.alias,"</div>",'<div class="weixin_choose_list_item_text">',i.corpname,"</div>","</div>","</div>"].join("")):"1"==n.owner&&t.push(['<div class="weixin_choose_list_item weixin_choose_list_item_admin" data-phone-uin="'+z((n=n).alias)+'" data-type="admin">','<div class="weixin_choose_list_item_icon">','<div class="weixin_choose_admin_icon"></div>',"</div>",'<div class="weixin_choose_list_item_content">','<div class="weixin_choose_list_item_title">\u7ba1\u7406\u5458</div>','<div class="weixin_choose_list_item_text">'+(z(n.corpname)||z(n.alias))+"</div>","</div>","</div>"].join(""))}return(0==e.length?['<div style="text-align: center;">','<div class="icon_warning_big"></div>','<div class="no_mail_found">\u65e0\u6cd5\u627e\u5230\u4f01\u4e1a</div>','<div class="no_mail_found_desc">\u8bf7\u6838\u5b9e\u4f60\u662f\u5426\u5b58\u5728\u8be5\u57df\u540d\u4e0b\u7684\u90ae\u7bb1\u5e10\u53f7\uff0c\u6216\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb</div>','<div class="signup_item" style="padding-bottom:81px;padding-top: 41px;">','<div class="signup_item_content">','<a href="javascript:location.reload();" class="login_btn">\u8fd4\u56de</a>',"</div>","</div>","</div>"]:t).join("")}function z(e,i){return"string"!=typeof e&&e&&e[0]&&e[0][i||"DATA"]!=undefined?e[0][i||"DATA"]:e}function E(e,i){0==$("#tipsContainer").length&&$("body").append('<div id="tipsContainer" style="display:none;"><div id="tipsTop" class="tipsWrap topPos size14" style="display:none;"><span class="msg"></span></div><div id="tipsMsg" class="tipsWrap tipsCenter size14" style="display:none;"><span class="msg"></span></div><div id="tipsProcess" class="tipsWrap tipsCenter size14" style="display:none;"><span class="msg" style="background-color:gray;"></span></div><div id="tipsError" class="tipsWrap tipsCenter size14" style="display:none;"><span class="msg" style="background-color:orange;"></span></div></div>'),showTips($("#tipsError"),e,i)}function N(e,i){var t;i=i||n,0<e?(p=!0,t=e-1,e=w("\u91cd\u65b0\u53d1\u9001(")+t+"S)",i.attr("disabled",!0),i.text(e),c=setTimeout(function(){N(t,i)},1e3)):(p=!1,i.removeAttr("disabled"),i.text(w("\u83b7\u53d6\u9a8c\u8bc1\u7801")),clearTimeout(c))}$(".js_verify_item").on("click",function(){$(".curr").removeClass("curr"),$(this).addClass("curr");var e=$(this).attr("data-type");$(".js_login_content").hide(),$(".js_"+e+"_content").show(),$(".js_wechat_item").hide(),$(".js_pwd_item").show(),"phone"==e&&(e=$(".js_"+e+"_content").find("#js_login_captcha_img")).attr("src",e.attr("src")+0)}),$(".js_pwd_item").on("click",function(){$(".js_wechat_item").show(),$(".js_pwd_item").hide(),$(".js_login_content").hide(),$(".js_pwd_content").show(),$('[data-type="wechat"]').hide(),$('[data-type="phone"]').hide(),$('[data-type="pwd"]').show()}),$(".js_wechat_item").on("click",function(){$(".js_wechat_item").hide(),$(".js_pwd_item").show(),$('[data-type="wechat"]').show(),$('[data-type="phone"]').show(),$('[data-type="pwd"]').hide(),$('[data-type="wechat"]').trigger("click")}),window.hasErrMsg&&$(".js_pwd_item").trigger("click"),t=new Dropdown({container:".js_countryCode_dropdown",dropDownClass:"qy_telInput_zipCode_input ",dropdownInputClass:"qy_inputText_Big",onChange:function(e){t.setText(e.value),i=+e.value},onHide:function(){(!t.isValidCode(t.getText())||i!=t.getText())&&t.setText(i)}}),$.extend(t,e),t.initialize(t.opt),t.selectByValue(i),t.scrollToSelectedItem(),n.on("click",function(){if($(this).attr("disabled"))return!1;var e=$.trim(o.val()),i=$.trim(s.val()),t=$.trim(m.val());I()?(C(o),N(60),$.ajax({url:"/cgi-bin/bizmail_portal?action=send_sms&type=11&t=biz_rf_portal_mgr&ef=jsnew&resp_charset=UTF8",data:{area:i,mobile:e,img_vc:t},dataType:"JSON",success:function(e){"0"==e.retcode||("-2"==e.retcode?L(n,w("\u5c1a\u672a\u7ed1\u5b9a\u624b\u673a\uff0c\u65e0\u6cd5\u53d1\u9001\u9a8c\u8bc1\u7801")):"-101"==e.retcode?L(n,w("\u64cd\u4f5c\u901f\u5ea6\u8fc7\u5feb\uff0c\u8bf71\u5206\u949f\u540e\u91cd\u65b0\u5c1d\u8bd5")):-201==e.retcode?(l.show(),_.trigger("click"),N(0),L(m,w("\u8bf7\u8f93\u5165\u56fe\u7247\u9a8c\u8bc1\u7801"))):-202==e.retcode?(L(m,w("\u56fe\u7247\u9a8c\u8bc1\u7801\u9519\u8bef")),N(0),_.trigger("click")):-1e4==e.retcode?(L(n,w("\u8be5\u624b\u673a\u53f7\u7684\u9a8c\u8bc1\u7801\u83b7\u53d6\u6b21\u6570\u5df2\u5230\u8fbe\u6bcf\u65e5\u4e0a\u9650")),N(0),n.addClass("disabled")):L(n,w("\u9a8c\u8bc1\u7801\u53d1\u9001\u5931\u8d25")))},complete:function(){}})):L(o,w("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801"))}),o.on("input propertychange",function(){h&&(I()?(p||n.removeAttr("disabled"),C(o)):(n.attr("disabled",!0),L(o,w("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801"))))}),o.on("blur",function(){h=!0}),y(r),y(o),m.on("focus",function(){C($(this))}),d.click(function(){var e=$.trim(o.val()),i=$.trim(s.val()),t=$.trim(r.val());if(u)return!1;if(I()){if(C(o),""!==$.trim(t)){C(r),u=!0;return $.ajax({url:"/cgi-bin/bizmail_portal?action=auth_sms&type=11&resp_charset=UTF8",method:"POST",data:{area:i,mobile:e,phone_vc:t,f:"json"},success:function(e){var i=z(e.errorcode);"0"==i?e.phone_login&&e.phone_login[0]&&e.phone_login[0].phone_alias?(e=e.phone_login[0].phone_alias||[],0===(e=$.grep(e,function(e){if(/\.qq\.com$/.test(location.hostname.toLowerCase()))return!0;var i=z(e.alias).split("@").pop(),e=z(e.domain_match);return("mail."+i).toLowerCase()==location.hostname.toLowerCase()||1==e})).length?(L(o,w("\u8be5\u624b\u673a\u6682\u65e0\u7ed1\u5b9a\u5e10\u53f7")),N(0),j("WwBizmailLogin","mobile_noresult")):1===e.length?z(e[0].alias)&&k(z(e[0].alias)):1<e.length&&(e=T(e),f.html(e),$(".js_input_area").hide(),$(".js_list_area").show())):(L(o,w("\u8be5\u624b\u673a\u6682\u65e0\u7ed1\u5b9a\u5e10\u53f7")),N(0),j("WwBizmailLogin","mobile_noresult")):L(n,w("-98"==i?"\u53c2\u6570\u9519\u8bef":"-99"==i?"\u9a8c\u8bc1\u7801\u9519\u8bef":"-101"==i||"-201"==i||"-202"==i?"\u64cd\u4f5c\u901f\u5ea6\u8fc7\u5feb\uff0c\u8bf71\u5206\u949f\u540e\u91cd\u65b0\u5c1d\u8bd5":"-300"==i?"\u7cfb\u7edf\u5931\u8d25":"\u9a8c\u8bc1\u7801\u53d1\u9001\u5931\u8d25"))},complete:function(){u=!1}}),!1}L(r,w("\u8bf7\u8f93\u5165\u77ed\u4fe1\u9a8c\u8bc1\u7801"))}else L(o,w("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801"))}),a.on("click","[data-phone-uin]",function(e){k($(this).attr("data-phone-uin"))}),$(document).on("click",".weixin_choose_list_item_member",function(e){var n=$(e.currentTarget),i=$(document.form1),o=n.attr("data-uin"),s=n.attr("data-type"),r=$('[name="login_from"]').val();if("1"==n.attr("data-verify")){var t=n.attr("data-mobile"),a=n.attr("data-area"),e=n.attr("data-uin");return location.href="/cgi-bin/loginpage?action=wx_login_choose&t=login_choose_account&tt=wx_login_choose&wx_login_code="+$('[name="wx_login_code"]').val()+"&find_mobile="+t+"&find_area="+a+"&find_alias="+e,!1}i.find("[name=uin]").val(o),i.find("[name=fun]").val(""),i.find("[name=f]").val("biz"),i.find("[name=t]").val("biz_rf_portal_mgr"),i.find("[name=ef]").val("jsnew");$.ajax("/cgi-bin/login",{type:"post",dataType:"json",data:i.serialize(),success:function(e){var i,t,a;""===e.data.errcode&&""!=e.data.sid?(a="biz_rf_home","true"==e.data.isWwBizmail&&(a="qy_rf_home"),1!=e.data.transfer_user_need_verify||1==e.data.gid_no_wechat?"feedback"==r?location.href="/cgi-bin/loginpage?sid="+e.data.sid+"&t=new_index/feedback":"BIZMAIL_ONLINESELL_FREE_TIP"===e.data.target?location.href="/cgi-bin/bizmail?sid="+e.data.sid+"&t="+a+"&init=1&onlinesell_index_tip=1#onlineorder/confirm/"+e.data.order_num:"BIZMAIL_ONLINESELL_ONLINEVIP_TIP"===e.data.target?location.href="/cgi-bin/bizmail?sid="+e.data.sid+"&t="+a+"&init=1&onlinesell_index_tip=3":"BIZMAIL_ONLINESELL_OFFLINEVIP_TIP"===e.data.target?location.href="/cgi-bin/bizmail?sid="+e.data.sid+"&t="+a+"&init=1&onlinesell_index_tip=2":"BIZMAIL_ONLINESELL_OFFLINETRIAL_TIP"===e.data.target?location.href="/cgi-bin/bizmail?sid="+e.data.sid+"&t="+a+"&init=1&onlinesell_index_tip=4#onlineorder/confirm/"+e.data.order_num:"BIZMAIL_ONLINESELL_ONLINETRIAL_TIP"===e.data.target?location.href="/cgi-bin/bizmail?sid="+e.data.sid+"&t="+a+"&init=1&onlinesell_index_tip=5#onlineorder/confirm/"+e.data.order_num:"admin"===s?(location.href="/cgi-bin/bizmail?sid="+e.data.sid+"&t="+a+"&init=1&r="+Math.random(),j("WwBizmailLogin","scan_login_"+(n.attr("data-admin")||"owner"))):location.href="/cgi-bin/frame_html?sid="+e.data.sid+"&r="+Math.random():(e.data.transfer_verify_area=e.data.transfer_verify_area||86,$(".js_merge_area").val(e.data.transfer_verify_area),$(".js_merge_mobile").val(e.data.transfer_verify_mobile),location.href="/cgi-bin/loginpage?t=login_choose_account&tt=wx_login_choose&login_fun=verify&area="+e.data.transfer_verify_area+"&mobile="+e.data.transfer_verify_mobile+"&merge_sid="+e.data.sid,i="biz_transfer",t="transfer|user|verify|page|view",a=$("#merge_sid").val()||$('[name="sid"]').val(),(new Image).src=a?"/cgi-bin/sellonlinestatic?type=session_statistics&businame="+i+"&item="+t+"&sid="+a:"/cgi-bin/sellonlinestatic?type=nosession_statistics&businame="+i+"&item="+t)):""===e.data.errcode&&""!=e.data.redirecturl?location.replace(e.data.redirecturl):"-60"==e.data.errcode?E(w("\u4f60\u7684\u4f01\u4e1a\u90ae\u7bb1\u5e10\u53f7\u88ab\u7981\u7528\uff0c\u8bf7\u8054\u7cfb\u4f01\u4e1a\u90ae\u7bb1\u7ba1\u7406\u5458\u3002")):"-61"==e.data.errcode&&e.data.sid?location.href="/cgi-bin/readtemplate?&nocheckframe=true&t=bizmail_usercpwd&sid="+e.data.sid+"&alias="+o:"-63"==e.data.errcode?E(w("\u7ba1\u7406\u5458\u9650\u5236\u8be5IP\u767b\u5f55\u4f01\u4e1a\u90ae\u7bb1\u3002")):E(w("\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5\u3002\u9519\u8bef\u7801\uff1a")+e.data.errcode)},error:function(e){E(w("\u7cfb\u7edf\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5"))}})}),$(document).on("scan_ready",function(e,t){document.form1.wx_login_code.value=t,$.ajax({url:"/cgi-bin/login?code="+t+"&vt=weixin&f=json",success:function(e){var i=z(e.target),e=z(e.sid);"WX_LOGIN_CHOOSE"==i?(i=t,$.ajax({url:"/cgi-bin/loginpage?action=wx_login_choose&t=login_choose_account&tt=wx_login_choose",method:"GET",data:{wx_login_code:i,f:"json"},success:function(e){var o,i=e.RetCode;"0"==i?(e=z(e.wx_login||{},"wx_alias"),o=[],$.each(e,function(e,i){var t,a,n;0==i.owner&&(a=(t=z(i.alias)).split("@").pop(),n=z(i.domain_match),("mail."+a).toLowerCase()!=location.hostname.toLowerCase()&&1!=n&&!/\.qq\.com$/.test(location.hostname.toLowerCase())||o.push({alias:t,autharea:z(i.autharea),authmobile:z(i.authmobile),need_verify:z(i.need_verify),corpname:z(i.corpname),owner:z(i.owner)}))}),x(o)):E(w("\u767b\u5f55\u5931\u8d25\uff0c\u9519\u8bef\u7801\uff1a")+i)},complete:function(){}})):e?(-1<e.indexOf(",")&&((e=e.split(","))[e.length-1]="7",e=e.join(",")),location.href="/cgi-bin/frame_html?sid="+e+"&r="+Math.random()):x([])}})}),$.extend($.fn,{setCookie:function(e,i,t){b(e,i,t)},delCookie:function(e){b(e,"",-1)}}),".qq.com"!==location.hostname.substr(-7)&&b("logout_page","",new Date(+new Date+864e5))});